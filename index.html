<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proje Hikayeleri Anketi</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 15px;
      line-height: 1.6;
      color: #333;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
      background: rgba(255,255,255,0.98);
      border-radius: 20px;
      padding: 25px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.15);
    }
    .header {
      text-align: center;
      margin-bottom: 25px;
      padding-bottom: 20px;
      border-bottom: 3px solid #3498db;
    }
    .header h1 {
      color: #2c3e50;
      font-size: 1.6em;
      margin-bottom: 10px;
      font-weight: 700;
    }
    .header p {
      color: #7f8c8d;
      font-size: 0.95em;
      margin-bottom: 12px;
    }
    .time-indicator {
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      color: white;
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 0.9em;
      font-weight: bold;
      display: inline-block;
      box-shadow: 0 4px 15px rgba(39,174,96,0.3);
    }
    
    /* Progress Indicator */
    .progress-container {
      margin: 20px 0;
      text-align: center;
    }
    .progress-bar-wrapper {
      background: #ecf0f1;
      height: 8px;
      border-radius: 20px;
      overflow: hidden;
      margin: 15px 0;
      position: relative;
    }
    .progress-bar {
      background: linear-gradient(90deg, #3498db, #2ecc71, #f39c12, #e74c3c);
      height: 100%;
      border-radius: 20px;
      transition: width 0.5s ease;
      width: 0%;
    }
    .progress-steps {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      font-size: 0.8em;
    }
    .progress-step {
      padding: 5px 10px;
      border-radius: 15px;
      font-weight: 600;
      color: #95a5a6;
      background: #ecf0f1;
      min-width: 60px;
      text-align: center;
    }
    .progress-step.completed {
      background: #27ae60;
      color: white;
    }
    .progress-step.active {
      background: #3498db;
      color: white;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(52, 152, 219, 0); }
      100% { box-shadow: 0 0 0 0 rgba(52, 152, 219, 0); }
    }
    
    /* Gamification */
    .achievement-panel {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 15px 20px;
      border-radius: 15px;
      margin: 20px 0;
      text-align: center;
    }
    .achievement-score {
      font-size: 1.5em;
      font-weight: bold;
      margin-bottom: 10px;
    }
    .achievement-badges {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .badge {
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
      border: 2px solid transparent;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 0.9em;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    .badge.earned {
      background: rgba(255,255,255,0.9);
      color: #2c3e50;
      border-color: #f39c12;
      box-shadow: 0 4px 15px rgba(243, 156, 18, 0.3);
      animation: bounce 0.6s ease-in-out;
    }
    @keyframes bounce {
      0%, 60%, 75%, 90%, 100% { transform: translateY(0); }
      15% { transform: translateY(-10px); }
      30% { transform: translateY(-5px); }
      45% { transform: translateY(-2px); }
    }
    .story-quality-indicator {
      background: #e8f4fd;
      border-left: 4px solid #3498db;
      padding: 10px 15px;
      margin-top: 10px;
      border-radius: 0 8px 8px 0;
      font-size: 0.9em;
      display: none;
    }
    .quality-score {
      font-weight: bold;
      color: #2980b9;
    }
    .encouragement-message {
      background: linear-gradient(45deg, #f39c12, #f1c40f);
      color: white;
      padding: 10px 15px;
      border-radius: 20px;
      margin: 15px 0;
      text-align: center;
      font-weight: bold;
      display: none;
      animation: slideDown 0.5s ease-out;
    }
    @keyframes slideDown {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    .multi-submission-note {
      background: #e8f4fd;
      border-left: 4px solid #3498db;
      padding: 12px 16px;
      margin-bottom: 20px;
      border-radius: 0 8px 8px 0;
      font-size: 0.9em;
    }
    .section {
      margin-bottom: 30px;
      background: #f8f9fa;
      border-radius: 16px;
      padding: 25px;
      border-left: 5px solid #3498db;
    }
    .section h3 {
      color: #2980b9;
      margin-bottom: 15px;
      font-size: 1.2em;
      font-weight: 600;
    }
    .question-item {
      margin-bottom: 20px;
    }
    .question-label {
      display: block;
      font-weight: 600;
      color: #34495e;
      margin-bottom: 10px;
      font-size: 1.02em;
    }
    .required { color: #e74c3c; }
    .optional { 
      color: #95a5a6;
      font-size: 0.9em;
      font-weight: 400;
    }
    .form-control {
      width: 100%;
      padding: 15px;
      border: 2px solid #ecf0f1;
      border-radius: 12px;
      font-size: 16px; /* iOS zoom Ã¶nleme */
      font-family: inherit;
      transition: all 0.3s ease;
      background: #fff;
    }
    .form-control:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 4px rgba(52,152,219,0.15);
      transform: translateY(-2px);
    }
    textarea.form-control {
      min-height: 120px;
      resize: vertical;
      line-height: 1.5;
    }
    .project-name-input {
      background: #fff9e6;
      border-color: #f39c12;
      margin-top: 10px;
    }
    .project-name-input:focus {
      border-color: #f39c12;
      box-shadow: 0 0 0 4px rgba(243,156,18,0.15);
    }
    .tip {
      background: linear-gradient(45deg, #e8f4fd, #f0f8ff);
      border-left: 4px solid #3498db;
      padding: 12px 16px;
      margin-top: 12px;
      font-size: 0.9em;
      color: #2980b9;
      border-radius: 0 8px 8px 0;
    }
    .consent-section {
      background: linear-gradient(45deg, #fff3cd, #fefbea);
      border: 2px solid #ffeaa7;
      border-radius: 12px;
      padding: 20px;
      margin: 25px 0;
    }
    .consent-checkbox {
      display: flex;
      gap: 12px;
      align-items: flex-start;
    }
    .consent-checkbox input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-top: 2px;
      flex-shrink: 0;
    }
    .submit-section {
      text-align: center;
      margin-top: 35px;
    }
    .btn-submit {
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      color: white;
      border: none;
      padding: 18px 35px;
      font-size: 17px;
      font-weight: bold;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(39,174,96,0.3);
      min-width: 200px;
    }
    .btn-submit:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(39,174,96,0.4);
    }
    .btn-submit:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    .completion-screen {
      display: none;
      text-align: center;
      padding: 40px 20px;
    }
    .completion-screen h2 {
      color: #27ae60;
      margin-bottom: 15px;
      font-size: 1.5em;
    }
    .completion-screen .success-message {
      background: linear-gradient(45deg, #d5edda, #e8f5e8);
      border: 2px solid #c3e6cb;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
    }
    
    /* Mobil optimizasyon */
    @media (max-width: 768px) {
      body { padding: 10px; }
      .container { 
        padding: 20px; 
        margin: 5px;
        border-radius: 16px;
      }
      .header h1 { font-size: 1.4em; }
      .section { 
        padding: 20px;
        margin-bottom: 25px;
      }
      .form-control {
        padding: 12px;
        font-size: 16px; /* iOS zoom Ã¶nleme */
      }
      textarea.form-control {
        min-height: 100px;
      }
      .btn-submit {
        width: 100%;
        padding: 16px;
        font-size: 16px;
      }
      .time-indicator {
        padding: 8px 16px;
        font-size: 0.85em;
      }
      .achievement-badges {
        gap: 5px;
      }
      .badge {
        padding: 6px 10px;
        font-size: 0.8em;
      }
    }
    
    /* Touch-friendly design */
    @media (pointer: coarse) {
      .form-control {
        padding: 16px;
        border-width: 3px;
      }
      .btn-submit {
        padding: 20px 35px;
        font-size: 18px;
      }
      .consent-checkbox input[type="checkbox"] {
        width: 22px;
        height: 22px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div id="survey-form">
      <div class="header">
        <h1>ğŸš€ Proje Hikayeleri Anketi</h1>
        <p>GerÃ§ek deneyimlerinizle proje yÃ¶netimi kitabÄ±na katkÄ±da bulunun</p>
        <div class="time-indicator">â±ï¸ Sadece 3 dakika</div>
      </div>

      <!-- Progress Indicator -->
      <div class="progress-container">
        <div class="progress-bar-wrapper">
          <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-steps">
          <div class="progress-step active" id="step0">Profil</div>
          <div class="progress-step" id="step1">BaÅŸarÄ±</div>
          <div class="progress-step" id="step2">Ä°nsan</div>
          <div class="progress-step" id="step3">Operasyon</div>
          <div class="progress-step" id="step4">Kriz</div>
        </div>
      </div>

      <!-- Achievement Panel -->
      <div class="achievement-panel" id="achievementPanel">
        <div class="achievement-score">
          ğŸ† Hikaye PuanÄ±nÄ±z: <span id="totalScore">0</span>/100
        </div>
        <div class="achievement-badges">
          <div class="badge" id="badgeProfile">ğŸ‘¤ Profil</div>
          <div class="badge" id="badgeSuccess">ğŸ¯ BaÅŸarÄ±</div>
          <div class="badge" id="badgeHuman">ğŸ‘¥ Ä°nsan</div>
          <div class="badge" id="badgeOps">âš¡ Operasyon</div>
          <div class="badge" id="badgeCrisis">ğŸ”¥ Kriz</div>
        </div>
      </div>

      <!-- Encouragement Messages -->
      <div class="encouragement-message" id="encouragementMsg"></div>

      <div class="multi-submission-note">
        <strong>ğŸ“ Not:</strong> FarklÄ± projelerle bu anketi birden Ã§ok kez doldurabilirsiniz. Her projeniz ayrÄ± deÄŸerli hikayeler iÃ§eriyor!
      </div>

      <form id="projectSurvey">
        <!-- Kimlik Bilgileri -->
        <div class="section">
          <h3>ğŸ‘¤ Ä°letiÅŸim Bilgileri</h3>
          <div class="question-item">
            <label class="question-label">
              Email Adresiniz <span class="optional">(kitap haberleri iÃ§in)</span>
            </label>
            <input type="email" class="form-control" name="email" placeholder="ornek@sirket.com">
          </div>
          <div class="question-item">
            <label class="question-label">
              Ad Soyad <span class="optional">(kitapta teÅŸekkÃ¼r bÃ¶lÃ¼mÃ¼nde yer alabilir)</span>
            </label>
            <input type="text" class="form-control" name="name" placeholder="Mehmet YÄ±lmaz">
          </div>
        </div>

        <!-- Temel Profil -->
        <div class="section">
          <h3>ğŸ’¼ Profiliniz</h3>
          <div class="question-item">
            <label class="question-label">
              Proje yÃ¶netimi deneyiminiz <span class="required">*</span>
            </label>
            <select class="form-control" name="experience" required>
              <option value="">Deneyim sÃ¼renizi seÃ§iniz</option>
              <option value="0-2">0-2 yÄ±l</option>
              <option value="3-5">3-5 yÄ±l</option>
              <option value="6-10">6-10 yÄ±l</option>
              <option value="10+">10+ yÄ±l</option>
            </select>
          </div>
          <div class="question-item">
            <label class="question-label">
              Hangi sektÃ¶rde Ã§alÄ±ÅŸÄ±yorsunuz? <span class="required">*</span>
            </label>
            <select class="form-control" name="sector" required>
              <option value="">SektÃ¶r seÃ§iniz</option>
              <option value="mobile">Mobil Uygulama GeliÅŸtirme</option>
              <option value="web">Web GeliÅŸtirme</option>
              <option value="ai">Yapay Zeka / Machine Learning</option>
              <option value="fintech">Fintech / Finansal Teknoloji</option>
              <option value="defense">Savunma Sanayi</option>
              <option value="ecommerce">E-ticaret</option>
              <option value="healthcare">SaÄŸlÄ±k</option>
              <option value="other">DiÄŸer</option>
            </select>
          </div>
        </div>

        <!-- 1. BaÅŸarÄ± Hikayesi -->
        <div class="section">
          <h3>ğŸ¯ En Gurur DuyduÄŸunuz BaÅŸarÄ±</h3>
          <div class="question-item">
            <label class="question-label">
              En gurur duyduÄŸunuz proje baÅŸarÄ±nÄ±zÄ± anlatÄ±n <span class="required">*</span>
            </label>
            <textarea 
              class="form-control" 
              name="success_story" 
              placeholder="Hangi projeyle gurur duyuyorsunuz? NasÄ±l baÅŸardÄ±nÄ±z? SonuÃ§ta neler deÄŸiÅŸti?"
              required
              oninput="analyzeStoryQuality(this, 'success')"
            ></textarea>
            <input type="text" class="form-control project-name-input" name="project_name" placeholder="Bu projenin adÄ± neydi? (Ã¶r: Mobil Banking UygulamasÄ±, CRM Sistemi)" oninput="updateProgress()">
            <div class="story-quality-indicator" id="successQuality">
              <div class="quality-score">ğŸ“Š Hikaye Kalitesi: <span id="successScore">0</span>/20</div>
            </div>
            <div class="tip">ğŸ’¡ Ä°yi hikaye iÃ§in: Projenin amacÄ± + ZorluklarÄ±nÄ±z + Ã‡Ã¶zÃ¼mÃ¼nÃ¼z + SonuÃ§lar</div>
          </div>
        </div>

        <!-- 2. Ä°nsan FaktÃ¶rÃ¼ -->
        <div class="section">
          <h3>ğŸ‘¥ Ä°nsan Dinamikleri</h3>
          <div class="question-item">
            <label class="question-label">
              Ekip veya insanlarla yaÅŸadÄ±ÄŸÄ±nÄ±z en zor durumu anlatÄ±n <span class="required">*</span>
            </label>
            <textarea 
              class="form-control" 
              name="human_challenge" 
              placeholder="Ekip Ã§atÄ±ÅŸmasÄ±, kilit kiÅŸinin ayrÄ±lmasÄ±, iletiÅŸim sorunu, uzaktan Ã§alÄ±ÅŸma zorluklarÄ±... Ne oldu ve nasÄ±l Ã§Ã¶zdÃ¼nÃ¼z?"
              required
              oninput="analyzeStoryQuality(this, 'human')"
            ></textarea>
            <div class="story-quality-indicator" id="humanQuality">
              <div class="quality-score">ğŸ“Š Hikaye Kalitesi: <span id="humanScore">0</span>/20</div>
            </div>
            <div class="tip">ğŸ’¡ OdaklanÄ±n: Sorun + YaklaÅŸÄ±mÄ±nÄ±z + SonuÃ§ + Ne Ã¶ÄŸrendiniz</div>
          </div>
        </div>

        <!-- 3. Operasyonel Zorluk -->
        <div class="section">
          <h3>âš¡ Operasyonel Zorluklar</h3>
          <div class="question-item">
            <label class="question-label">
              Zaman, bÃ¼tÃ§e, teknoloji gibi operasyonel zorluklarÄ±nÄ±zÄ± anlatÄ±n <span class="required">*</span>
            </label>
            <textarea 
              class="form-control" 
              name="operational_challenge" 
              placeholder="Deadline baskÄ±sÄ±, bÃ¼tÃ§e kÄ±sÄ±tlarÄ±, teknoloji deÄŸiÅŸimi, kaynak yetersizliÄŸi... Hangi zorluklarla karÅŸÄ±laÅŸtÄ±nÄ±z ve nasÄ±l baÅŸa Ã§Ä±ktÄ±nÄ±z?"
              required
              oninput="analyzeStoryQuality(this, 'ops')"
            ></textarea>
            <div class="story-quality-indicator" id="opsQuality">
              <div class="quality-score">ğŸ“Š Hikaye Kalitesi: <span id="opsScore">0</span>/20</div>
            </div>
            <div class="tip">ğŸ’¡ DetaylandÄ±rÄ±n: KÄ±sÄ±t + Etkisi + AldÄ±ÄŸÄ±nÄ±z aksiyonlar + SonuÃ§</div>
          </div>
        </div>

        <!-- 4. Kriz Senaryosu -->
        <div class="section">
          <h3>ğŸ”¥ En BÃ¼yÃ¼k Kriz AnÄ±nÄ±z</h3>
          <div class="question-item">
            <label class="question-label">
              YaÅŸadÄ±ÄŸÄ±nÄ±z en bÃ¼yÃ¼k proje krizini anlatÄ±n <span class="required">*</span>
            </label>
            <textarea 
              class="form-control" 
              name="biggest_crisis" 
              placeholder="Her ÅŸey ters giderken neler yaÅŸadÄ±nÄ±z? Panik anlarÄ±, kritik kararlar, son dakika Ã§Ã¶zÃ¼mleri... Krizi nasÄ±l atlattÄ±nÄ±z?"
              required
              oninput="analyzeStoryQuality(this, 'crisis')"
            ></textarea>
            <div class="story-quality-indicator" id="crisisQuality">
              <div class="quality-score">ğŸ“Š Hikaye Kalitesi: <span id="crisisScore">0</span>/20</div>
            </div>
            <div class="tip">ğŸ’¡ Hikaye anlatÄ±n: Krizin baÅŸlangÄ±cÄ± + En zor anlar + Ã‡Ã¶zÃ¼m sÃ¼reci + Ã‡Ä±karÄ±lan dersler</div>
          </div>
        </div>

        <!-- KVKK OnayÄ± -->
        <div class="consent-section">
          <div class="consent-checkbox">
            <input type="checkbox" id="consent" name="consent" required>
            <label for="consent">
              <strong>KVKK ve Ä°Ã§erik OnayÄ±:</strong> Hikayelerimin kitap Ã§alÄ±ÅŸmasÄ±nda kullanÄ±lmasÄ±na, gerektiÄŸinde anonimleÅŸtirilerek yayÄ±nlanmasÄ±na ve (istersem) ismimin teÅŸekkÃ¼r bÃ¶lÃ¼mÃ¼nde geÃ§mesine onay veriyorum. 
              <a href="#" onclick="showKvkkModal()" style="color: #3498db; font-weight: 600;">DetaylarÄ± oku</a>
            </label>
          </div>
        </div>

        <!-- Submit -->
        <div class="submit-section">
          <button type="submit" class="btn-submit" id="submitBtn" disabled>
            ğŸ“š Hikayelerimi PaylaÅŸ
          </button>
          <div style="margin-top: 15px; font-size: 0.9em; color: #7f8c8d; line-height: 1.5;">
            Verileriniz gÃ¼venli ÅŸekilde kaydedilir<br>
            FarklÄ± projeler iÃ§in tekrar doldurabilirsiniz
          </div>
        </div>
      </form>
    </div>

    <!-- BaÅŸarÄ± EkranÄ± -->
    <div id="success-screen" class="completion-screen">
      <h2>ğŸ™ Hikayeleriniz Kaydedildi!</h2>
      <div class="success-message">
        <p><strong>TeÅŸekkÃ¼r ederiz!</strong></p>
        <p>Deneyimleriniz proje yÃ¶netimi literatÃ¼rÃ¼ne deÄŸerli katkÄ±lar saÄŸlayacak.</p>
        <p style="margin-top: 15px;">
          ğŸ“§ SorularÄ±nÄ±z iÃ§in: <strong>anket@projegercegi.com</strong>
        </p>
      </div>
      <button onclick="resetForm()" style="padding: 15px 25px; background: linear-gradient(45deg, #3498db, #5dade2); color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(52,152,219,0.3);">
        ğŸ”„ BaÅŸka Proje Ä°Ã§in Yeni Form Doldur
      </button>
    </div>
  </div>

  <script>
    // Progress and Gamification System
    let currentProgress = 0;
    let achievementScores = {
      profile: 0,
      success: 0,
      human: 0,
      ops: 0,
      crisis: 0
    };

    const encouragementMessages = [
      "ğŸ”¥ Harika baÅŸlangÄ±Ã§! Devam edin!",
      "ğŸ’ª Ã‡ok iyi gidiyorsunuz! Hikayeleriniz deÄŸerli.",
      "ğŸš€ SÃ¼persiniz! Neredeyse tamamladÄ±nÄ±z.",
      "ğŸ† MÃ¼kemmel! Son adÄ±mdasÄ±nÄ±z!",
      "ğŸ¯ Tebrikler! Harika hikayeler yazdÄ±nÄ±z!"
    ];

    const qualityKeywords = {
      solution: ['Ã§Ã¶zdÃ¼m', 'Ã§Ã¶zdÃ¼k', 'Ã§Ã¶zÃ¼m', 'karar', 'strateji', 'yÃ¶ntem', 'baÅŸardÄ±m', 'organize', 'koordine'],
      problem: ['problem', 'sorun', 'zorluk', 'kriz', 'baÅŸarÄ±sÄ±z', 'hata', 'gecikmÉ™', 'bÃ¼tÃ§e', 'deadline'],
      emotion: ['stresli', 'endiÅŸeli', 'panik', 'mutlu', 'gurur', 'baÅŸarÄ±', 'zorlandÄ±m', 'korkuttu', 'rahatladÄ±m'],
      team: ['ekip', 'takÄ±m', 'team', 'Ã§alÄ±ÅŸan', 'manager', 'lead', 'developer', 'client', 'mÃ¼ÅŸteri'],
      technical: ['sistem', 'uygulama', 'kod', 'test', 'deploy', 'server', 'database', 'API', 'bug', 'feature']
    };

    function updateProgress() {
      const form = document.getElementById('projectSurvey');
      const formData = new FormData(form);
      let completedSections = 0;

      // Profile section (20 points)
      if (formData.get('experience') && formData.get('sector')) {
        achievementScores.profile = 20;
        earnBadge('Profile');
        completedSections++;
      }

      // Story sections (20 points each)
      const stories = ['success_story', 'human_challenge', 'operational_challenge', 'biggest_crisis'];
      stories.forEach((story, index) => {
        const value = formData.get(story);
        if (value && value.trim().length > 0) {
          completedSections++;
        }
      });

      currentProgress = (completedSections / 5) * 100;
      document.getElementById('progressBar').style.width = currentProgress + '%';

      // Update step indicators
      for (let i = 0; i <= 4; i++) {
        const step = document.getElementById(`step${i}`);
        if (i < completedSections) {
          step.className = 'progress-step completed';
        } else if (i === completedSections) {
          step.className = 'progress-step active';
        } else {
          step.className = 'progress-step';
        }
      }

      // Update total score
      const totalScore = Object.values(achievementScores).reduce((sum, score) => sum + score, 0);
      document.getElementById('totalScore').textContent = totalScore;

      // Show encouragement
      if (completedSections > 0 && Math.random() > 0.7) {
        showEncouragement(completedSections - 1);
      }
    }

    function analyzeStoryQuality(textarea, type) {
      const text = textarea.value.toLowerCase();
      let score = 0;
      
      // Length scoring (0-8 points)
      if (text.length > 500) score += 8;
      else if (text.length > 300) score += 6;
      else if (text.length > 150) score += 4;
      else if (text.length > 50) score += 2;

      // Keyword scoring (0-12 points)
      Object.keys(qualityKeywords).forEach(category => {
        const found = qualityKeywords[category].filter(word => text.includes(word)).length;
        if (found > 0) score += Math.min(found * 0.8, 3); // Max 3 points per category
      });

      // Bonus for story structure (if contains beginning, middle, end indicators)
      const structureWords = ['Ã¶nce', 'sonra', 'ardÄ±ndan', 'daha sonra', 'o zaman', 'sonuÃ§', 'Ã§Ã¶zÃ¼m', 'karar'];
      const structureCount = structureWords.filter(word => text.includes(word)).length;
      if (structureCount >= 3) score += 4;
      else if (structureCount >= 1) score += 2;

      score = Math.min(Math.round(score), 20); // Cap at 20
      achievementScores[type] = score;

      // Update UI
      const scoreElement = document.getElementById(`${type}Score`);
      const qualityIndicator = document.getElementById(`${type}Quality`);
      
      if (scoreElement) {
        scoreElement.textContent = score;
        if (score >= 15) {
          scoreElement.style.color = '#27ae60';
          scoreElement.innerHTML = `${score} â­`;
        } else if (score >= 10) {
          scoreElement.style.color = '#f39c12';
          scoreElement.innerHTML = `${score} âœ“`;
        }
      }

      if (qualityIndicator && text.length > 10) {
        qualityIndicator.style.display = 'block';
      }

      // Earn badges based on quality
      if (score >= 15) {
        earnBadge(type.charAt(0).toUpperCase() + type.slice(1));
      }

      updateProgress();
    }

    function earnBadge(badgeType) {
      const badgeMap = {
        'Profile': 'badgeProfile',
        'Success': 'badgeSuccess', 
        'Human': 'badgeHuman',
        'Ops': 'badgeOps',
        'Crisis': 'badgeCrisis'
      };

      const badgeElement = document.getElementById(badgeMap[badgeType]);
      console.log('Rozet kazanma denemesi:', badgeType, badgeElement);
      
      if (badgeElement && !badgeElement.classList.contains('earned')) {
        badgeElement.classList.add('earned');
        console.log('âœ… Rozet kazanÄ±ldÄ±:', badgeType);
        
        // KullanÄ±cÄ±ya gÃ¶rsel geri bildirim
        badgeElement.style.background = 'rgba(255,255,255,0.95) !important';
        badgeElement.style.color = '#2c3e50 !important';
        badgeElement.style.borderColor = '#f39c12 !important';
        badgeElement.style.transform = 'scale(1.1)';
        
        // GeÃ§ici mesaj gÃ¶ster
        const encouragementElement = document.getElementById('encouragementMsg');
        const messages = {
          'Profile': 'âœ… Bilgiler tamamlandÄ±!',
          'Success': 'ğŸ¯ BaÅŸarÄ± hikayesi rozetini kazandÄ±nÄ±z!',
          'Human': 'ğŸ‘¥ Ä°nsan dinamikleri rozetini kazandÄ±nÄ±z!',
          'Ops': 'âš¡ Operasyon rozetini kazandÄ±nÄ±z!',
          'Crisis': 'ğŸ”¥ Kriz rozetini kazandÄ±nÄ±z!'
        };
        
        encouragementElement.textContent = messages[badgeType] || 'Rozet kazandÄ±nÄ±z!';
        encouragementElement.style.display = 'block';
        encouragementElement.style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
        
        setTimeout(() => {
          encouragementElement.style.display = 'none';
          badgeElement.style.animation = 'none';
        }, 3000);
      }
    }

    function showEncouragement(level) {
      const encouragementElement = document.getElementById('encouragementMsg');
      if (level < encouragementMessages.length) {
        encouragementElement.innerHTML = encouragementMessages[level]; // innerHTML for emojis
        encouragementElement.style.display = 'block';
        
        setTimeout(() => {
          encouragementElement.style.display = 'none';
        }, 3000);
      }
    }

    function showScoreBasedEncouragement(totalScore) {
      const encouragementElement = document.getElementById('encouragementMsg');
      let messages, bgColor;
      
      if (totalScore >= 80) {
        messages = scoreBasedMessages.high;
        bgColor = 'linear-gradient(45deg, #f39c12, #f1c40f)'; // Gold
      } else if (totalScore >= 60) {
        messages = scoreBasedMessages.medium; 
        bgColor = 'linear-gradient(45deg, #9b59b6, #8e44ad)'; // Purple
      } else if (totalScore >= 30) {
        messages = scoreBasedMessages.low;
        bgColor = 'linear-gradient(45deg, #3498db, #5dade2)'; // Blue
      } else {
        return; // Don't show message for very low scores
      }
      
      const randomMessage = messages[Math.floor(Math.random() * messages.length)];
      encouragementElement.innerHTML = randomMessage; // innerHTML for emojis
      encouragementElement.style.background = bgColor;
      encouragementElement.style.display = 'block';
      
      setTimeout(() => {
        encouragementElement.style.display = 'none';
      }, 4000);
    }

    // Form geÃ§erliliÄŸi kontrolÃ¼ (enhanced)
    function checkFormValidity() {
      const form = document.getElementById('projectSurvey');
      const required = form.querySelectorAll('[required]');
      const submitBtn = document.getElementById('submitBtn');
      
      let allValid = true;
      
      required.forEach(field => {
        if (field.type === 'checkbox') {
          if (!field.checked) allValid = false;
        } else if (field.tagName === 'TEXTAREA') {
          if (field.value.trim().length === 0) allValid = false;
        } else if (field.tagName === 'SELECT') {
          if (!field.value) allValid = false;
        }
      });
      
      submitBtn.disabled = !allValid;
      
      // Enhanced button styling based on completion
      const totalScore = Object.values(achievementScores).reduce((sum, score) => sum + score, 0);
      if (allValid) {
        if (totalScore >= 80) {
          submitBtn.style.background = 'linear-gradient(45deg, #8e44ad, #9b59b6)';
          submitBtn.textContent = 'ğŸ† MÃ¼kemmel Hikayeleri PaylaÅŸ';
        } else if (totalScore >= 60) {
          submitBtn.style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
          submitBtn.textContent = 'â­ Kaliteli Hikayeleri PaylaÅŸ';
        } else {
          submitBtn.style.background = 'linear-gradient(45deg, #3498db, #5dade2)';
          submitBtn.textContent = 'ğŸ“š Hikayelerimi PaylaÅŸ';
        }
      } else {
        submitBtn.style.background = '#95a5a6';
        submitBtn.textContent = 'ğŸ“ Formu TamamlayÄ±n';
      }
    }

    // Event listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize progress - baÅŸlangÄ±Ã§ta profil aktif olsun
      currentProgress = 20; // BaÅŸlangÄ±Ã§ %20 
      document.getElementById('progressBar').style.width = '20%';
      document.getElementById('step0').className = 'progress-step active';
      
      // Force show elements
      document.getElementById('achievementPanel').style.display = 'block';
      document.querySelector('.progress-container').style.display = 'block';
      
      // Test iÃ§in initial badges
      console.log('Form loaded, elements visible');
      
      // TÃ¼m required alanlara event listener ekle
      const requiredFields = document.querySelectorAll('[required]');
      requiredFields.forEach(field => {
        field.addEventListener('input', () => {
          checkFormValidity();
          updateProgress();
          console.log('Field updated:', field.name);
        });
        field.addEventListener('change', () => {
          checkFormValidity();
          updateProgress();
          console.log('Field changed:', field.name);
        });
      });
      
      // Tekstarea'lar iÃ§in Ã¶zel davranÄ±ÅŸ
      const textareas = document.querySelectorAll('textarea');
      textareas.forEach(textarea => {
        textarea.addEventListener('input', function() {
          // Auto-resize
          this.style.height = 'auto';
          this.style.height = this.scrollHeight + 'px';
          console.log('Textarea updated:', this.name);
        });
      });

      // Achievement panel hover effect
      const achievementPanel = document.getElementById('achievementPanel');
      achievementPanel.addEventListener('mouseenter', () => {
        const totalScore = Object.values(achievementScores).reduce((sum, score) => sum + score, 0);
        if (totalScore > 0) {
          achievementPanel.style.transform = 'scale(1.02)';
        }
      });
      achievementPanel.addEventListener('mouseleave', () => {
        achievementPanel.style.transform = 'scale(1)';
      });
      
      // Ä°lk yÃ¼klemede profil rozetini test et
      setTimeout(() => {
        earnBadge('Profile');
        updateProgress();
      }, 1000);
    });

    // Form submit (enhanced with gamification data)
    document.getElementById('projectSurvey').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const submitBtn = document.getElementById('submitBtn');
      submitBtn.textContent = 'ğŸš€ GÃ¶nderiliyor...';
      submitBtn.disabled = true;
      
      // Form verilerini topla
      const formData = new FormData(this);
      const responses = {};
      for (let [key, value] of formData.entries()) {
        responses[key] = value.trim();
      }
      
      console.log('ğŸ“¤ Form verileri:', responses);
      
      // Gamification data
      const totalScore = Object.values(achievementScores).reduce((sum, score) => sum + score, 0);
      responses.submission_date = new Date().toLocaleString('tr-TR');
      responses.version = 'gamified_v3.0_fixed';
      responses.total_quality_score = totalScore;
      responses.section_scores = JSON.stringify(achievementScores);
      responses.completion_percentage = currentProgress;
      responses.earned_badges = Array.from(document.querySelectorAll('.badge.earned')).length;
      responses.user_agent = navigator.userAgent;
      responses.form_language = 'turkish';
      
      // Google Sheets iÃ§in tÃ¼m gerekli alanlarÄ± ekle
      const requiredFields = {
        // Ana form alanlarÄ±
        'full_name': responses.full_name || responses.name || '',
        'email_address': responses.email_address || responses.email || '',
        'company_name': responses.company_name || '',
        'job_title': responses.job_title || '',
        'linkedin_profile': responses.linkedin_profile || '',
        'privacy_preference': responses.privacy_preference || '',
        'sector': responses.sector || '',
        'experience': responses.experience || '',
        'team_size': responses.team_size || '',
        'project_count': responses.project_count || '',
        'biggest_budget': responses.biggest_budget || '',
        'work_email': responses.work_email || '',
        
        // Hikaye alanlarÄ±
        'biggest_crisis': responses.biggest_crisis || '',
        'success_story': responses.success_story || '',
        'human_challenge': responses.human_challenge || '',
        'operational_challenge': responses.operational_challenge || '',
        
        // Eksik alanlarÄ± boÅŸ string olarak ekle
        'deadline_crisis': '',
        'budget_crisis': '',
        'tech_change': '',
        'demo_crisis': '',
        'key_person_left': '',
        'team_conflict': '',
        'management_pressure': '',
        'remote_issues': '',
        'client_issues': '',
        'sector_challenge': '',
        'compliance_issues': '',
        'security_impact': '',
        'market_changes': '',
        'additional_experiences': '',
        'book_suggestions': '',
        'contact_info': '',
        
        // Proje ismi
        'project_name': responses.project_name || ''
      };
      
      // Responses'a gerekli alanlarÄ± ekle
      Object.assign(responses, requiredFields);
      
      // Kalite hesaplamalarÄ±
      responses.total_chars = (responses.success_story || '').length + 
                              (responses.human_challenge || '').length + 
                              (responses.operational_challenge || '').length + 
                              (responses.biggest_crisis || '').length;
      responses.quality_score = totalScore;
      responses.quality_indicators = Array.from(document.querySelectorAll('.badge.earned')).map(b => b.textContent).join(', ');
      responses.consistency_warnings = '';
      
      console.log('ğŸ“‹ GÃ¶nderilen tam veri:', responses);
      
      // Google Sheets'e gÃ¶nder
      const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby6SJZqR3EF2Bu6Xhf3h-AySzLpRFTTOcX4bMTnfmD3HXXA9_5ch1yGL-54SfsMmVB2/exec';
      
      fetch(GOOGLE_SCRIPT_URL, {
        method: 'POST',
        mode: 'no-cors',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(responses)
      }).catch(() => {
        console.log('Form gÃ¶nderildi');
      });
      
      // BaÅŸarÄ± ekranÄ±nÄ± gÃ¶ster
      setTimeout(() => {
        document.getElementById('survey-form').style.display = 'none';
        document.getElementById('success-screen').style.display = 'block';
        
        // Success screen enhancement
        const successScreen = document.getElementById('success-screen');
        if (totalScore >= 80) {
          successScreen.innerHTML = `
            <h2>ğŸ† MÃ¼kemmel! ${totalScore}/100 Puan!</h2>
            <div class="success-message">
              <p><strong>Hikaye UstasÄ±!</strong></p>
              <p>YazdÄ±ÄŸÄ±nÄ±z hikayeler Ã§ok kaliteli. Kitapta Ã¶zel bir yere sahip olacaklar.</p>
              <p style="margin-top: 15px;">ğŸ“§ SorularÄ±nÄ±z iÃ§in: <strong>anket@projegercegi.com</strong></p>
            </div>
            <button onclick="resetForm()" style="padding: 15px 25px; background: linear-gradient(45deg, #8e44ad, #9b59b6); color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(142,68,173,0.3);">
              ğŸ”¥ BaÅŸka Proje Ä°Ã§in Yeni Form Doldur
            </button>
          `;
        } else if (totalScore >= 60) {
          successScreen.innerHTML = `
            <h2>â­ Harika! ${totalScore}/100 Puan!</h2>
            <div class="success-message">
              <p><strong>Ã‡ok iyi hikayeler!</strong></p>
              <p>Deneyimleriniz proje yÃ¶netimi literatÃ¼rÃ¼ne deÄŸerli katkÄ±lar saÄŸlayacak.</p>
              <p style="margin-top: 15px;">ğŸ“§ SorularÄ±nÄ±z iÃ§in: <strong>anket@projegercegi.com</strong></p>
            </div>
            <button onclick="resetForm()" style="padding: 15px 25px; background: linear-gradient(45deg, #27ae60, #2ecc71); color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(39,174,96,0.3);">
              âœ¨ BaÅŸka Proje Ä°Ã§in Yeni Form Doldur
            </button>
          `;
        }
        
        window.scrollTo(0, 0);
      }, 1000);
    });

    // Form sÄ±fÄ±rlama (enhanced)
    function resetForm() {
      document.getElementById('survey-form').style.display = 'block';
      document.getElementById('success-screen').style.display = 'none';
      document.getElementById('projectSurvey').reset();
      
      // Reset gamification
      currentProgress = 0;
      achievementScores = { profile: 0, success: 0, human: 0, ops: 0, crisis: 0 };
      
      // Reset UI elements
      document.getElementById('progressBar').style.width = '0%';
      document.getElementById('totalScore').textContent = '0';
      
      // Reset badges
      document.querySelectorAll('.badge').forEach(badge => {
        badge.classList.remove('earned');
      });
      
      // Reset quality indicators
      document.querySelectorAll('.story-quality-indicator').forEach(indicator => {
        indicator.style.display = 'none';
      });
      
      // Reset step indicators
      for (let i = 0; i <= 4; i++) {
        const step = document.getElementById(`step${i}`);
        if (i === 0) {
          step.className = 'progress-step active';
        } else {
          step.className = 'progress-step';
        }
      }
      
      // Textarea boyutlarÄ±nÄ± sÄ±fÄ±rla
      const textareas = document.querySelectorAll('textarea');
      textareas.forEach(textarea => {
        textarea.style.height = 'auto';
      });
      
      checkFormValidity();
      window.scrollTo(0, 0);
    }

    function showKvkkModal() {
      alert(`KVKK AydÄ±nlatma Metni ve Ä°Ã§erik OnayÄ±:

Toplanan Veriler: Ad-soyad, e-posta ve proje hikayeleriniz
AmaÃ§: Proje GerÃ§eÄŸi kitabÄ±nÄ±n hazÄ±rlanmasÄ±
Ä°ÅŸleme: Hikayeleriniz anonimleÅŸtirilerek kitapta kullanÄ±labilir
Saklama: Kitap tamamlanana kadar gÃ¼venli ÅŸekilde saklanÄ±r
HaklarÄ±nÄ±z: DilediÄŸiniz zaman verilerinizin silinmesini talep edebilirsiniz

Ä°letiÅŸim: anket@projegercegi.com

Bu onayÄ± vererek hikayelerinizin kitap projesi kapsamÄ±nda kullanÄ±lmasÄ±na izin vermiÅŸ olursunuz.`);
    }

    // Mobil scroll optimize (enhanced)
    let lastScrollTop = 0;
    window.addEventListener('scroll', function() {
      const st = window.pageYOffset || document.documentElement.scrollTop;
      const header = document.querySelector('.header');
      const achievementPanel = document.getElementById('achievementPanel');
      
      if (st > lastScrollTop && st > 100) {
        // Scrolling down
        header.style.transform = 'translateY(-10px)';
        header.style.opacity = '0.9';
        achievementPanel.style.position = 'sticky';
        achievementPanel.style.top = '10px';
        achievementPanel.style.zIndex = '100';
      } else {
        // Scrolling up
        header.style.transform = 'translateY(0)';
        header.style.opacity = '1';
        achievementPanel.style.position = 'relative';
        achievementPanel.style.top = 'auto';
      }
      lastScrollTop = st <= 0 ? 0 : st;
    }, false);
  </script>
</body>
</html>
